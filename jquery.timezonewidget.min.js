"use strict";
/*
jquery.timezonewidget.min.js - provided by timezoneWidget - LGPL license
https://github.com/peterjtracey/timezoneWidget
*/
(function(e){e.fn.timezoneWidget=function(t){var n=e.extend({},e.fn.timezoneWidget.defaults,t);"string"==typeof n.data&&(n.data=JSON.parse(n.data)),n.tz=n.data;var l={elem:null,tz:[],regions:[],timezones:[],regSelect:null,tzSelect:null,selectedRegion:-1,selectedTimezone:"",userClickedRegion:!1,draw:function(){if(e("#"+n.tzField).length>0&&(l.selectedTimezone=e("#"+n.tzField).val(),l.selectedRegion=e("#"+n.regionField).val()),e("#"+n.regionField).length&&l.selectedRegion.length>0)l.selectedRegion=parseInt(l.selectedRegion);else if(n.guessUserTimezone){var t=new Date,i=t+"";i=i.split(/GMT/),i.length>0&&(i=i[1].split(/ /),i=i[0],5==i.length&&(i="UTC"+i.substring(0,3)+":"+i.substring(3,6)),9==i.length?e.each(n.tz,function(e,t){var n=l.findOffset(t,i);if(n)return!1}):n.defaultRegion&&(l.selectedRegion=n.defaultRegion))}else n.defaultRegion&&(l.selectedRegion=n.defaultRegion);l.regSelect=e("<select/>").attr("size",n.tz.length).addClass("tz_region_select"),e.each(n.tz,function(t,n){l.regSelect.append(e("<option/>").val(n.id).text(n.label))}),l.elem.append(l.regSelect),l.elem.append(e("<div/>").addClass("tz_timezone_container")),l.regSelect.change(function(){l.selectedRegion=parseInt(e(this).val()),l.elem.find(".tz_timezone_container").html(""),l.tzSelect=e("<select data-placeholder='Select a timezone...'/>").append("<option value=''/>").addClass("tz_timezone_select"),l.getZones(function(t,n){var i=t.split(/\//);l.tzSelect.append(e("<option/>").val(t).text(n+" "+i[1].replace(/_/g," ")+(i.length>2?"/"+i[2]:"")))}),l.selectedTimezone.length>0&&l.tzSelect.val(l.selectedTimezone),l.elem.find(".tz_timezone_container").html(l.tzSelect),l.elem.find(".tz_timezone_select").chosen(),l.elem.find(".tz_timezone_select").change(function(){l.selectedTimezone=e(this).val(),e("#"+n.tzField).val(l.selectedTimezone),e("#"+n.regionField).val(l.selectedRegion),n.onTimezoneSelect(l.selectedRegion,l.selectedTimezone)}),l.selectedTimezone.length>0&&null!=l.tzSelect.val()?l.tzSelect.trigger("change"):n.onRegionSelect(l.selectedRegion)}),l.selectedRegion>0&&(l.regSelect.val(l.selectedRegion),l.regSelect.change(),l.regSelect.hover(function(){l.userClickedRegion=!0}),l.regSelect.focus(function(){l.userClickedRegion||(l.elem.find(".tz_timezone_select+div").trigger("mousedown"),l.userClickedRegion=!1)}))},findOffset:function(t,n){var i=!1;return e.each(t.timezones,function(o,c){e.each(c.labels,function(e,o){if(c.offsetLabel.indexOf(n)!=-1)return l.selectedRegion=t.id,l.selectedTimezone=o,i=!0,!1})}),i},getZones:function(t){e.each(n.tz,function(n,i){if(i.id==l.selectedRegion)return e.each(i.timezones,function(n,l){e.each(l.labels,function(e,n){t(n,l.offsetLabel)})}),!1})}};return l.elem=this,this.addClass("tzwidget"),l.draw(),this},e.fn.timezoneWidget.defaults={regionField:"tz_region",tzField:"timezone",data:null,defaultRegion:1024,guessUserTimezone:!1,onRegionSelect:e.noop(),onTimezoneSelect:e.noop()}}(jQuery));